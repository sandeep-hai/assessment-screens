<div class="analytics-container">
  <!-- Header -->
  <div class="analytics-header-bar">
    <div class="header-content">
      <h2>Exam Analytics</h2>
      <div class="header-actions">
        <span class="welcome-user">{{ getCurrentUserName() }}</span>
        <button mat-raised-button color="warn" (click)="logout()">
          <mat-icon>logout</mat-icon>
          Switch User
        </button>
      </div>
    </div>
  </div>

  <div class="analytics-content">
    <div class="analytics-header">
      <h1>Performance Analytics</h1>
      <p>Track your exam performance and identify improvement areas</p>
    </div>

    <!-- Overall Statistics -->
    <div class="stats-section">
      <h2>Overall Performance</h2>
      <div class="stats-grid">
        <mat-card class="stat-card">
          <mat-card-content>
            <div class="stat-icon">
              <mat-icon>quiz</mat-icon>
            </div>
            <div class="stat-info">
              <div class="stat-value">{{ overallStats.totalExams }}</div>
              <div class="stat-label">Total Exams</div>
            </div>
          </mat-card-content>
        </mat-card>

        <mat-card class="stat-card">
          <mat-card-content>
            <div class="stat-icon">
              <mat-icon>trending_up</mat-icon>
            </div>
            <div class="stat-info">
              <div class="stat-value">{{ overallStats.averageScore }}%</div>
              <div class="stat-label">Average Score</div>
              <div class="stat-trend" [style.color]="getTrendColor(overallStats.improvementTrend)">
                {{ overallStats.improvementTrend }}
              </div>
            </div>
          </mat-card-content>
        </mat-card>

        <mat-card class="stat-card">
          <mat-card-content>
            <div class="stat-icon">
              <mat-icon>star</mat-icon>
            </div>
            <div class="stat-info">
              <div class="stat-value">{{ overallStats.highestScore }}%</div>
              <div class="stat-label">Highest Score</div>
            </div>
          </mat-card-content>
        </mat-card>

        <mat-card class="stat-card">
          <mat-card-content>
            <div class="stat-icon">
              <mat-icon>show_chart</mat-icon>
            </div>
            <div class="stat-info">
              <div class="stat-value">{{ overallStats.lowestScore }}%</div>
              <div class="stat-label">Lowest Score</div>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </div>

    <!-- Subject-wise Performance -->
    <mat-card class="performance-card">
      <mat-card-header>
        <mat-card-title>Subject-wise Performance</mat-card-title>
        <mat-card-subtitle>Detailed breakdown by subject</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <div class="performance-list">
          <div *ngFor="let subject of performanceData" class="performance-item">
            <div class="subject-info">
              <h4>{{ subject.subject }}</h4>
              <p>{{ subject.exams }} exams taken</p>
            </div>
            <div class="performance-stats">
              <div class="average-score">{{ subject.average }}%</div>
              <div class="trend" [style.color]="getTrendColor(subject.trend)">
                <mat-icon>{{ subject.trend.startsWith('+') ? 'trending_up' : 'trending_down' }}</mat-icon>
                {{ subject.trend }}
              </div>
            </div>
            <div class="progress-section">
              <div class="progress-bar">
                <div class="progress-fill" [style.width.%]="subject.average"></div>
              </div>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Recent Exams -->
    <mat-card class="recent-exams-card">
      <mat-card-header>
        <mat-card-title>Recent Exam Results</mat-card-title>
        <mat-card-subtitle>Your latest exam performances</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <div class="recent-exams-list">
          <div *ngFor="let exam of recentExams" class="exam-item">
            <div class="exam-info">
              <h4>{{ exam.title }}</h4>
              <p>{{ exam.date | date:'mediumDate' }}</p>
            </div>
            <div class="exam-score">
              <div class="score-value">{{ exam.score }}%</div>
              <mat-chip [style.background-color]="getGradeColor(exam.grade)" class="grade-chip">
                {{ exam.grade }}
              </mat-chip>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Performance Chart Placeholder -->
    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>Performance Trends</mat-card-title>
        <mat-card-subtitle>Score progression over time</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <div class="chart-placeholder">
          <mat-icon>insert_chart</mat-icon>
          <h3>Interactive Charts Coming Soon</h3>
          <p>Detailed performance graphs and trend analysis will be available here</p>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>