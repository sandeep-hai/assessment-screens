<div class="dashboard-container fade-in">
  <!-- Header with logout -->
  <div class="dashboard-header-bar">
    <div class="header-content">
      <h2>Assessment Tool</h2>
      <div class="header-actions">
        <span class="welcome-user">Welcome, {{ getCurrentUserName() }}</span>
        <button mat-raised-button color="warn" (click)="logout()">
          <mat-icon>logout</mat-icon>
          Switch User
        </button>
      </div>
    </div>
  </div>

  <div class="dashboard-content">
    <div class="dashboard-header">
      <h1>Student Dashboard</h1>
      <p class="welcome-text">Welcome back! Here's what's happening today.</p>
    </div>

    <!-- Stats Cards -->
    <div class="stats-grid grid-container grid-cols-4">
      <mat-card class="stat-card dashboard-card" (click)="navigateToExams()">
        <mat-icon class="stat-icon">assignment</mat-icon>
        <h3>{{ dashboardStats.pendingExams || 0 }}</h3>
        <p>Pending Exams</p>
      </mat-card>

      <mat-card class="stat-card dashboard-card" (click)="navigateToAssignments()">
        <mat-icon class="stat-icon">assignment_turned_in</mat-icon>
        <h3>{{ dashboardStats.completedAssignments || 0 }}</h3>
        <p>Completed Assignments</p>
      </mat-card>

      <mat-card class="stat-card dashboard-card" (click)="navigateToEvents()">
        <mat-icon class="stat-icon">event</mat-icon>
        <h3>{{ dashboardStats.upcomingEvents || 0 }}</h3>
        <p>Upcoming Events</p>
      </mat-card>

      <mat-card class="stat-card dashboard-card">
        <mat-icon class="stat-icon">grade</mat-icon>
        <h3>{{ dashboardStats.currentGrade || 'N/A' }}</h3>
        <p>Current Grade</p>
      </mat-card>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions-section">
      <h2>Quick Actions</h2>
      <div class="quick-actions-grid">
        <button mat-raised-button color="primary" class="action-btn" (click)="navigateToExams()">
          <mat-icon>quiz</mat-icon>
          Take Exam
        </button>
        <button mat-raised-button color="accent" class="action-btn" (click)="navigateToEvents()">
          <mat-icon>event</mat-icon>
          View Events
        </button>
        <button mat-raised-button class="action-btn" (click)="navigateToPolls()">
          <mat-icon>poll</mat-icon>
          Participate in Polls
        </button>
      </div>
    </div>

    <!-- Activity Feed -->
    <mat-card class="content-card feed-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>dynamic_feed</mat-icon>
          Activity Feed
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <!-- Events Feed -->
        <div *ngIf="upcomingEvents$ | async as events">
          <div *ngFor="let event of events" class="feed-item event-feed-item">
            <div class="feed-header">
              <div class="feed-avatar">
                <mat-icon>event</mat-icon>
              </div>
              <div class="feed-info">
                <h4>{{ event.title }}</h4>
                <p class="feed-time">{{ event.startDate | date:'medium' }}</p>
              </div>
              <mat-chip [class]="'status-' + event.type">{{ event.type | titlecase }}</mat-chip>
            </div>
            <p class="feed-content">{{ event.description }}</p>
            <div class="feed-details">
              <span><mat-icon>schedule</mat-icon>{{ event.startDate | date:'shortTime' }} - {{ event.endDate | date:'shortTime' }}</span>
              <span><mat-icon>{{ event.isVirtual ? 'videocam' : 'location_on' }}</mat-icon>{{ event.isVirtual ? 'Virtual Event' : event.location }}</span>
            </div>
            <mat-divider></mat-divider>
            <div class="feed-actions">
              <button mat-raised-button color="primary" (click)="joinEvent(event)">Join Event</button>
              <button mat-button (click)="sharePost(event)"><mat-icon>share</mat-icon>Share</button>
              <button mat-button (click)="savePost(event)"><mat-icon>bookmark</mat-icon>Save</button>
            </div>
          </div>
        </div>

        <!-- Polls Feed -->
        <div *ngIf="activePolls$ | async as polls">
          <div *ngFor="let poll of polls" class="feed-item poll-feed-item">
            <div class="feed-header">
              <div class="feed-avatar poll-avatar">
                <mat-icon>poll</mat-icon>
              </div>
              <div class="feed-info">
                <h4>Poll</h4>
                <p class="feed-time">{{ poll.createdAt | date:'medium' }}</p>
              </div>
              <mat-chip class="status-active">Active</mat-chip>
            </div>
            <h3 class="poll-question">{{ poll.question }}</h3>
            <div class="poll-options">
              <button 
                *ngFor="let option of poll.options" 
                mat-stroked-button 
                class="poll-option"
                (click)="vote(poll, option)">
                <span>{{ option }}</span>
                <span class="vote-count">{{ poll.votes[option] || 0 }} votes</span>
              </button>
            </div>
            <p class="poll-total">{{ poll.totalVotes }} total votes</p>
            <mat-divider></mat-divider>
            <div class="feed-actions">
              <button mat-button (click)="likePost(poll)"><mat-icon>thumb_up</mat-icon>Like</button>
              <button mat-button (click)="commentOnPost(poll)"><mat-icon>comment</mat-icon>Comment</button>
              <button mat-button (click)="sharePost(poll)"><mat-icon>share</mat-icon>Share</button>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Available Exams -->
    <mat-card class="content-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>quiz</mat-icon>
          Available Exams
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div *ngIf="availableExams$ | async as exams" class="exams-grid grid-container grid-cols-3">
          <div *ngFor="let exam of exams" class="exam-card">
            <div class="exam-info">
              <h4>{{ exam.title }}</h4>
              <p>{{ exam.description }}</p>
              <div class="exam-details">
                <span><mat-icon>schedule</mat-icon>{{ exam.duration }} min</span>
                <span><mat-icon>grade</mat-icon>{{ exam.totalMarks }} marks</span>
              </div>
              <mat-chip [class]="'exam-type-' + exam.type">{{ exam.type | titlecase }}</mat-chip>
            </div>
            <div class="exam-actions">
              <button mat-raised-button color="primary" (click)="takeExam(exam.id)">
                Take Exam
              </button>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
        <mat-icon>logout</mat-icon>
        Switch User
      </button>
    </div>
  </div>

  <div class="dashboard-header">
    <h1>Student Dashboard</h1>
    <p class="welcome-text">Welcome back! Here's what's happening today.</p>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid grid-container grid-cols-4">
    <mat-card class="stat-card dashboard-card">
      <mat-icon class="stat-icon">assignment</mat-icon>
      <h3>{{ dashboardStats.pendingExams || 0 }}</h3>
      <p>Pending Exams</p>
    </mat-card>

    <mat-card class="stat-card dashboard-card">
      <mat-icon class="stat-icon">assignment_turned_in</mat-icon>
      <h3>{{ dashboardStats.completedAssignments || 0 }}</h3>
      <p>Completed Assignments</p>
    </mat-card>

    <mat-card class="stat-card dashboard-card">
      <mat-icon class="stat-icon">event</mat-icon>
      <h3>{{ dashboardStats.upcomingEvents || 0 }}</h3>
      <p>Upcoming Events</p>
    </mat-card>

    <mat-card class="stat-card dashboard-card">
      <mat-icon class="stat-icon">grade</mat-icon>
      <h3>{{ dashboardStats.currentGrade || 'N/A' }}</h3>
      <p>Current Grade</p>
    </mat-card>
  </div>

  <!-- Activity Feed -->
  <mat-card class="content-card feed-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>dynamic_feed</mat-icon>
        Activity Feed
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <!-- Events Feed -->
      <div *ngIf="upcomingEvents$ | async as events">
        <div *ngFor="let event of events" class="feed-item event-feed-item">
          <div class="feed-header">
            <div class="feed-avatar">
              <mat-icon>event</mat-icon>
            </div>
            <div class="feed-info">
              <h4>{{ event.title }}</h4>
              <p class="feed-time">{{ event.startDate | date:'medium' }}</p>
            </div>
            <mat-chip [class]="'status-' + event.type">{{ event.type | titlecase }}</mat-chip>
          </div>
          <p class="feed-content">{{ event.description }}</p>
          <div class="feed-details">
            <span><mat-icon>schedule</mat-icon>{{ event.startDate | date:'shortTime' }} - {{ event.endDate | date:'shortTime' }}</span>
            <span><mat-icon>{{ event.isVirtual ? 'videocam' : 'location_on' }}</mat-icon>{{ event.isVirtual ? 'Virtual Event' : event.location }}</span>
          </div>
          <mat-divider></mat-divider>
          <div class="feed-actions">
            <button mat-raised-button color="primary" (click)="joinEvent(event)">Join Event</button>
            <button mat-button><mat-icon>share</mat-icon>Share</button>
            <button mat-button><mat-icon>bookmark</mat-icon>Save</button>
          </div>
        </div>
      </div>

      <!-- Polls Feed -->
      <div *ngIf="activePolls$ | async as polls">
        <div *ngFor="let poll of polls" class="feed-item poll-feed-item">
          <div class="feed-header">
            <div class="feed-avatar poll-avatar">
              <mat-icon>poll</mat-icon>
            </div>
            <div class="feed-info">
              <h4>Poll</h4>
              <p class="feed-time">{{ poll.createdAt | date:'medium' }}</p>
            </div>
            <mat-chip class="status-active">Active</mat-chip>
          </div>
          <h3 class="poll-question">{{ poll.question }}</h3>
          <div class="poll-options">
            <button 
              *ngFor="let option of poll.options" 
              mat-stroked-button 
              class="poll-option"
              (click)="vote(poll, option)">
              <span>{{ option }}</span>
              <span class="vote-count">{{ poll.votes[option] || 0 }} votes</span>
            </button>
          </div>
          <p class="poll-total">{{ poll.totalVotes }} total votes</p>
          <mat-divider></mat-divider>
          <div class="feed-actions">
            <button mat-button><mat-icon>thumb_up</mat-icon>Like</button>
            <button mat-button><mat-icon>comment</mat-icon>Comment</button>
            <button mat-button><mat-icon>share</mat-icon>Share</button>
          </div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Available Exams -->
  <mat-card class="content-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>quiz</mat-icon>
        Available Exams
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div *ngIf="availableExams$ | async as exams" class="exams-grid grid-container grid-cols-3">
        <div *ngFor="let exam of exams" class="exam-card">
          <div class="exam-info">
            <h4>{{ exam.title }}</h4>
            <p>{{ exam.description }}</p>
            <div class="exam-details">
              <span><mat-icon>schedule</mat-icon>{{ exam.duration }} min</span>
              <span><mat-icon>grade</mat-icon>{{ exam.totalMarks }} marks</span>
            </div>
            <mat-chip [class]="'exam-type-' + exam.type">{{ exam.type | titlecase }}</mat-chip>
          </div>
          <div class="exam-actions">
            <button mat-raised-button color="primary" [routerLink]="['/student/take-exam', exam.id]">
              Take Exam
            </button>
          </div>
        </div>
      </div>
    </mat-card-content>
  </mat-card>
</div>